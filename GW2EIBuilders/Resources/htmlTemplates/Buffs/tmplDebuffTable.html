<template>
    <div>
        <buff-table-component :key="'debuff-stats-table'" :condition="false" :generation="false"
            :id="'debuff-stats-table'" :buffs="debuffs" :playerdata="buffData" :sums="[]" :playerindex="playerindex" :hidecustom="false">
        </buff-table-component>
    </div>
</template>

<script>
    Vue.component("debuff-table-component", {
        props: ['playerindex', 'activeduration'],
        mixins: [buffComponent, encounterPhaseComponent],
        template: `${template}`,
        data: function () {
            return {
                cache: new Map()
            };
        },
        computed: {
            buffData: function () {
                const id = this.encounterPhase.id + '-' + this.phaseindex + '-' + this.activeduration;
                if (this.cache.has(id)) {
                    return this.cache.get(id);
                }

                const players = getActiveNonFakePlayersForPhase(this.encounterPhase);
                var getData = function (stats) {
                    const uptimes = [];
                    for (let i = 0; i < players.length; i++) {
                        const player = players[i];
                        if (!player) {
                            continue;
                        }
                        uptimes.push({
                            player: player,
                            data: stats[i]
                        });
                    }
                    return uptimes;
                };
                let res;
                if (this.activeduration) {
                    res = getData(this.buffsStatContainer.debuffActiveStats);
                } else {
                    res = getData(this.buffsStatContainer.debuffStats);
                }
                this.cache.set(id, res);
                return res;
            }
        },
    });
</script>